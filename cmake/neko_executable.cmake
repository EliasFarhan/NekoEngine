set(COMPILER_WARNING_FLAGS "")
set(COMPILER_FLAGS "")
if(MSVC)
    set(COMPILER_WARNING_FLAGS " /W4 ")
    set(COMPILER_FLAGS " /arch:AVX2 /Oi /GR- /EHs-c- ")
elseif(UNIX)
    set(COMPILER_WARNING_FLAGS "-Wall -Wextra -Wswitch-default -Wmissing-declarations \
        -Wmissing-include-dirs -Wredundant-decls  -Wshadow -Wdouble-promotion \
        -Wundef -fno-common ")
    set(COMPILER_FLAGS " -fno-rtti -fno-exceptions ")
endif()

function(neko_bin_config binary)
    set_target_properties(${binary} PROPERTIES UNITY_BUILD ON)
    set_property(TARGET ${binary} APPEND_STRING PROPERTY COMPILE_FLAGS " ${COMPILER_FLAGS} ${COMPILER_WARNING_FLAGS} ")
    if(UNIX)
        if(NOT ARM AND NOT Neko_Android)
            set_property(TARGET ${binary} APPEND_STRING PROPERTY COMPILE_FLAGS " -march=haswell ")
        endif()
    endif()
endfunction()

function(neko_lib_config library)
    set_target_properties(${library} PROPERTIES UNITY_BUILD ON)
    set_property(TARGET ${library} APPEND_STRING PROPERTY COMPILE_FLAGS " ${COMPILER_FLAGS} ${COMPILER_WARNING_FLAGS} ")
    if(UNIX)
        if(NOT ARM AND NOT Neko_Android)
            set_property(TARGET ${library} APPEND_STRING PROPERTY COMPILE_FLAGS " -march=haswell ")
        endif()
    endif()
endfunction()
